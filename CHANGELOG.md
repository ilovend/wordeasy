# WordEasy 更新日志

## v1.5.0 - 2025-11-26 词库增强版（开发中）

### ✨ 新功能

#### 📚 词库管理全面升级

**三种灵活的导入方式**：
1. **✏️ 快速添加单词**
   - 手动输入单个单词和释义
   - 支持回车键快速提交
   - 适合临时添加少量生词

2. **📋 批量添加**
   - 支持粘贴多行文本
   - 自动识别多种分隔符：
     - 空格：`word meaning`
     - Tab：`word	meaning`
     - 竖线：`word|meaning`
   - 适合从笔记/文档复制词汇

3. **📤 文件导入**
   - 支持多种格式自动识别：
     - TXT: `word|meaning` 或 `word meaning`
     - CSV: `word,meaning`
     - JSON: 数组或对象格式
   - 适合导入大批量词库

**🔄 内置格式转换器**：
- 在线转换不同格式的词库
- 自动检测输入格式（CSV、JSON、TXT）
- 支持多种JSON结构（数组/对象）
- 转换后可直接上传或复制使用
- 无需安装Python工具，浏览器内完成

**功能特点**：
- ✅ 多格式智能识别
- ✅ 实时格式转换
- ✅ 自动去重处理
- ✅ 批量操作支持
- ✅ 友好的错误提示
- ✅ 实时统计更新

**使用场景**：
- 📝 课堂/阅读中临时记录生词 → 快速添加
- 📋 整理笔记本中的词汇 → 批量添加
- 📚 导入标准词库（CET4/6等）→ 文件导入
- 🔄 格式不匹配的词库 → 使用转换器

#### 🛠️ 智能转换工具整合

**命令行工具（`tools/convert_vocab.py`）**：
- 统一的转换接口，自动识别格式
- 支持 CSV、JSON、TXT、ECDICT数据库
- 详细的转换日志和统计
- 完整的命令行参数支持

查看详情：
- [工具使用文档](tools/README.md)
- [快速开始指南](tools/QUICK_START.md)
- [词库导入完整指南](docs/WORD_IMPORT_GUIDE.md)

---

## v1.4.0 - 2025-11-26 稳定性增强版

### 🔧 Bug 修复与优化

#### 闯关模式快捷键修复
- ✅ 修复闯关模式答对后 Enter 键无法进入下一题的问题
- ✅ 修复进入下一题后需要手动点击才能聚焦输入框的问题
- ✅ 修复复习模式/错词本模式结束后显示"难度参数错误"的问题
- ✅ 答对、答错后自动聚焦到输入框
- ✅ 优化快捷键事件处理逻辑
- ✅ 分离学习模式和挑战模式的快捷键处理
- ✅ 增加难度有效性检查，防止无效参数调用API

#### 代码质量改进
- ✅ 移除生产环境中的调试console.log
- ✅ 改进数据库初始化错误处理
- ✅ 优化API版本号管理（统一为1.3.0）
- ✅ 修复注释和文档描述

#### 测试与工具
- ✅ 新增API端点单元测试 (`backend/tests/test_api.py`)
- ✅ 新增性能基准测试工具 (`backend/tests/test_performance.py`)
- ✅ 新增健康检查脚本 (`health_check.py`)
- ✅ 自动检测和修复常见问题

#### 文档完善
- ✅ 更新项目改进总结文档
- ✅ 添加更多测试覆盖
- ✅ 改进错误提示信息

### 🛠️ 新增工具

#### 健康检查工具
```bash
python health_check.py
```
功能：
- 检查Python和Node.js版本
- 验证依赖安装状态
- 检查数据库和文件结构
- 检测端口占用
- 自动修复常见问题

#### 性能测试工具
```bash
cd backend
python tests/test_performance.py
```
功能：
- 基准测试所有主要API
- 性能指标分析
- 优化建议

---

## 2025-11-25 迭代更新

### ✨ 新功能

#### 1. TTS 发音功能
- ✅ 集成浏览器原生 Web Speech API
- ✅ 支持美式英语发音（自动选择最佳语音）
- ✅ 在拼写游戏界面添加"听发音"按钮
- ✅ 播放状态提示，防止重复点击
- 📁 新增文件：`frontend/src/utils/tts.js`

#### 2. 智能拼写错误提示
- ✅ 逐字符差异对比显示
- ✅ 绿色标记正确字母
- ✅ 红色划线标记错误字母
- ✅ 蓝色下划线标记缺失字母
- ✅ 直观的错误分析，帮助快速纠正
- 📁 新增文件：`frontend/src/utils/stringDiff.js`

#### 3. 速拼挑战模式 ⚡
- ✅ 10个单词，60秒倒计时挑战
- ✅ 支持三个难度等级选择
- ✅ 实时正确率统计
- ✅ 本地最高纪录保存
- ✅ 新纪录提示和庆祝动画
- ✅ 支持跳过功能
- 📁 新增文件：`frontend/src/views/SpeedChallenge.vue`
- 📁 更新路由：`frontend/src/router/index.js`
- 📁 更新首页：`frontend/src/views/Home.vue`（添加入口）

### 🐛 Bug 修复

#### 上传词库问题修复
- ✅ 修复 UNIQUE 约束冲突（重复单词导致500错误）
- ✅ 优化批量查询，一次性检查所有重复单词
- ✅ 添加文件内去重逻辑
- ✅ 增加事务回滚机制
- ✅ 详细的上传反馈（导入数量 + 跳过数量）
- 📁 优化文件：`backend/app/main.py`

#### 词库统计问题修复
- ✅ 修复总单词数限制在3000的问题
- ✅ 新增 `/api/words/stats` 专用统计端点
- ✅ 使用数据库 `count()` 直接统计，精确高效
- 📁 后端新增：`backend/app/main.py` - 统计API
- 📁 前端新增：`frontend/src/api/index.js` - `getWordStats()`
- 📁 前端优化：`frontend/src/components/WordList.vue`

#### 网络错误优化
- ✅ 上传超时从 60秒 增加到 120秒
- ✅ 添加 `maxContentLength` 和 `maxBodyLength` 无限制
- ✅ 详细的错误分类提示（超时/网络/服务器）
- ✅ 添加控制台日志便于调试
- 📁 优化文件：`frontend/src/api/index.js`
- 📁 优化文件：`frontend/src/components/WordList.vue`

### 🛠️ 辅助工具

- ✅ `restart.bat` - 快速重启前后端服务
- ✅ `check_services.bat` - 诊断服务运行状态

---

## 功能对比

| 功能 | 原版本 | 当前版本 | 状态 |
|------|--------|----------|------|
| 拼写攻防战 | ✅ | ✅ | 已完成 |
| TTS 发音 | ❌ | ✅ | 新增 |
| 错误提示 | 基础 | 智能差异分析 | 优化 |
| 速拼挑战 | ❌ | ✅ | 新增 |
| 复习模式 | ✅ | ✅ | 已完成 |
| 词库管理 | ✅ | ✅ | 已优化 |
| 词库上传 | 有bug | 完善 | 已修复 |
| 词库统计 | 有限制 | 精确统计 | 已修复 |
| 网络超时 | 60秒 | 120秒 | 已优化 |

---

## 📊 技术指标

- **前端包体积**: < 500KB（Tailwind 按需引入）
- **后端性能**: 批量插入优化（bulk_save_objects）
- **数据库**: SQLite 单文件，支持数万单词
- **浏览器兼容**: Chrome/Edge/Firefox（支持 Web Speech API）
- **离线支持**: 除发音外全功能可用

---

## 🚀 使用方法

### 启动服务
```powershell
# 方式1：一键启动
.\start.bat

# 方式2：单独重启
.\restart.bat

# 方式3：诊断服务
.\check_services.bat
```

### 访问地址
- **前端**: http://localhost:5173
- **后端**: http://localhost:8000
- **API文档**: http://localhost:8000/docs

---

## 📝 待优化功能

### 高优先级
- [ ] 错词歼灭战模式增强
- [ ] 学习统计可视化（图表）

### 中优先级
- [ ] 移动端响应式优化
- [ ] 主题切换（暗黑模式）

### 低优先级
- [ ] Electron 桌面打包
- [ ] 多用户支持（可选）

---

## 🎯 下次迭代方向

1. **数据可视化**: 学习进度曲线、正确率趋势图
2. **错词本强化**: 专项练习模式，针对性复习
3. **成就系统**: 徽章、连胜、里程碑
4. **社交分享**: 成绩分享（可选）

---

**开发团队**: AI Assistant + Claude Sonnet 4.5  
**更新日期**: 2025年11月25日  
**版本**: v1.1.0
